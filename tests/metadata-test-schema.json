{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Metadata Test Cases Schema",
  "description": "Schema for documenting metadata extraction test cases and results",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version"
    },
    "lastUpdated": {
      "type": "string",
      "format": "date",
      "description": "Last time test cases were updated"
    },
    "testCases": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/testCase"
      }
    },
    "categories": {
      "type": "object",
      "description": "Site categories for organization"
    },
    "failureModes": {
      "type": "object",
      "description": "Tracking of failure mode occurrences"
    }
  },
  "definitions": {
    "testCase": {
      "type": "object",
      "required": ["id", "url", "siteName", "category"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for test case"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Product URL to test"
        },
        "siteName": {
          "type": "string",
          "description": "Name of the e-commerce site"
        },
        "category": {
          "type": "string",
          "enum": ["e-commerce", "fashion", "marketplace", "crowdfunding", "direct-to-consumer", "other"],
          "description": "Category of site"
        },
        "status": {
          "type": "string",
          "enum": ["pending", "tested", "passed", "failed"],
          "description": "Test status"
        },
        "microlinkResult": {
          "type": "object",
          "properties": {
            "title": { "type": "string" },
            "description": { "type": "string" },
            "imageUrl": { "type": "string" },
            "price": { "type": "string" },
            "error": { "type": "string" }
          },
          "description": "What Microlink actually returned"
        },
        "expectedResult": {
          "type": "object",
          "required": ["title", "description", "imageUrl"],
          "properties": {
            "title": {
              "type": "string",
              "description": "Expected product title"
            },
            "description": {
              "type": "string",
              "description": "Expected product description"
            },
            "imageUrl": {
              "type": "string",
              "format": "uri",
              "description": "Expected product image URL"
            },
            "price": {
              "type": "string",
              "description": "Expected price (optional)"
            },
            "currency": {
              "type": "string",
              "description": "Expected currency code (ISO 4217)"
            },
            "availability": {
              "type": "string",
              "enum": ["in_stock", "out_of_stock", "preorder", "discontinued"],
              "description": "Expected availability status"
            },
            "brand": {
              "type": "string",
              "description": "Expected brand name"
            }
          },
          "description": "What we expect to extract"
        },
        "issues": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of issues found (e.g., 'Wrong image', 'No price')"
        },
        "severity": {
          "type": "string",
          "enum": ["critical", "major", "minor", "unknown"],
          "description": "How badly this case fails"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about this test case"
        }
      }
    }
  }
}
